(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[686],{24863:(e,t,s)=>{Promise.resolve().then(s.bind(s,48661))},48661:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>I});var n,i,a,r=s(57437),l=s(2265),o=s(54719),c=s(67671),h=s(60603),d=s(55448),u=s(8284),m=s(74798),p=s(83004),g=s(95256),x=s(81887),j=s(47971);let N=e=>{var t;let{isOpen:s,onClose:n,recipe:i}=e;return(0,r.jsx)(m.R,{isOpen:s,placement:"center",onClose:n,isDismissable:!0,children:(0,r.jsxs)(p.A,{className:"text-black",children:[(0,r.jsx)(g.k,{children:(0,r.jsx)("h2",{children:i.recipeName})}),(0,r.jsxs)(x.I,{children:[(0,r.jsx)("p",{children:i.description}),(0,r.jsxs)("p",{children:["Meal Type: ",i.mealType]}),(0,r.jsxs)("p",{children:["Dish Type: ",i.dishType]}),(0,r.jsxs)("p",{children:["Dietary Preference: ",i.dietaryPreference]}),(0,r.jsxs)("p",{children:["Created by: ",i.creatorUsername]}),(0,r.jsx)("h4",{children:"Ingredients:"}),(0,r.jsx)("ul",{children:null===(t=i.recipeIngredients)||void 0===t?void 0:t.map((e,t)=>(0,r.jsxs)("li",{children:[e.amount," ",e.unit," of"," ",e.ingredientName]},t))}),(0,r.jsx)("h4",{children:"Instructions:"}),(0,r.jsx)("p",{children:i.instructions})]}),(0,r.jsx)(j.R,{children:(0,r.jsx)(u.A,{className:"bg-danger",onClick:n,children:"Close"})})]})})},E=e=>{let{recipe:t}=e,[s,n]=(0,l.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.w,{children:(0,r.jsxs)(d.G,{children:[(0,r.jsx)("div",{className:"w-full text-center content-center",children:t.recipeName}),(0,r.jsx)("div",{children:t.description}),(0,r.jsxs)("div",{children:["Meal Type: ",t.mealType]}),(0,r.jsxs)("div",{children:["Dish Type: ",t.dishType]}),(0,r.jsxs)("div",{children:["Recipe created by: ",t.creatorUsername]}),(0,r.jsx)(u.A,{onClick:()=>{n(!0)},children:"View Recipe"})]})}),(0,r.jsx)(N,{isOpen:s,onClose:()=>{n(!1)},recipe:t})]})};var S=s(62121),v=s(87970),A=s(8127),f=s(80123);!function(e){e.VEGETARIAN="VEGETARIAN",e.NON_VEGETARIAN="NON_VEGETARIAN",e.VEGAN="VEGAN",e.GLUTEN_FREE="GLUTEN_FREE"}(n||(n={})),function(e){e.BREAKFAST="BREAKFAST",e.LUNCH="LUNCH",e.DINNER="DINNER",e.SNACK="SNACK"}(i||(i={}));class T{toString(){return"".concat(this.amount," ").concat(this.unit," of ").concat(this.ingredientName)}constructor(e,t,s){this.amount=e,this.unit=t,this.ingredientName=s}}!function(e){e[e.APPETIZER=0]="APPETIZER",e[e.MAIN_COURSE=1]="MAIN_COURSE",e[e.SIDE_DISH=2]="SIDE_DISH",e[e.DESSERT=3]="DESSERT",e[e.SNACK=4]="SNACK",e[e.BEVERAGE=5]="BEVERAGE",e[e.STREET_FOOD=6]="STREET_FOOD"}(a||(a={}));let y=e=>{let{isOpen:t,onClose:s}=e,[o,h]=(0,l.useState)(""),[d,N]=(0,l.useState)(""),[E,y]=(0,l.useState)(null),[I,b]=(0,l.useState)(null),[k,C]=(0,l.useState)(null),[R,w]=(0,l.useState)(""),[O,U]=(0,l.useState)([]),[D,G]=(0,l.useState)(!1),P=(e,t,s)=>{U(n=>n.map((n,i)=>i===e?{...n,[t]:s}:n))},_=e=>{U(t=>t.filter((t,s)=>s!==e))},F=()=>""!==o&&""!==d&&null!==E&&null!==k&&""!==R&&O.every(e=>""!==e.ingredientName&&e.amount>0&&null!==e.unit),V=async()=>{if(!F())return;G(!0);let e=O.map(e=>({name:e.ingredientName,amount:e.amount,unit:e.unit}));try{c.Z.post("recipes/add",{ingredientsList:e,dishType:I,mealType:E,dietaryPreference:k,recipeName:o,description:d,instructions:R})}catch(e){console.error("Failed to upload recipe:",e)}G(!1),s()};return(0,r.jsx)(m.R,{isOpen:t,placement:"center",onClose:s,children:(0,r.jsxs)(p.A,{className:"text-black",children:[(0,r.jsx)(g.k,{children:(0,r.jsx)("h2",{children:"New Recipe!"})}),(0,r.jsxs)(x.I,{children:[(0,r.jsx)(S.Y,{label:"Recipe Name",placeholder:"Recipe Name",value:o,isInvalid:""===o,onValueChange:h}),(0,r.jsx)(v.g,{label:"Dish Type",placeholder:"Select Dish type",value:I||"",onChange:e=>b(e.target.value),children:Object.values(a).map(e=>(0,r.jsx)(A.R,{value:e,children:e},e))}),(0,r.jsx)(v.g,{label:"Meal Type",placeholder:"Select meal type",value:E||"",onChange:e=>y(e.target.value),children:Object.values(i).map(e=>(0,r.jsx)(A.R,{value:e,children:e},e))}),(0,r.jsx)(v.g,{label:"Dietary Preference",placeholder:"Select dietary preference",value:k||"",onChange:e=>C(e.target.value),children:Object.values(n).map(e=>(0,r.jsx)(A.R,{value:e,children:e},e))}),(0,r.jsx)(f.Y,{value:d,onValueChange:N,placeholder:"Description",isInvalid:""===d}),(0,r.jsx)(f.Y,{label:"Instructions",placeholder:"How to make this recipe",value:R,onValueChange:w,isInvalid:""===R}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{children:"Ingredients"}),O.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,r.jsx)(S.Y,{label:"Name",placeholder:"Ingredient name",value:e.ingredientName,onValueChange:e=>P(t,"ingredientName",e)}),(0,r.jsx)(S.Y,{label:"Amount",placeholder:"Amount",type:"number",min:"0",value:e.amount.toString(),onValueChange:e=>P(t,"amount",parseFloat(e))}),(0,r.jsx)(S.Y,{label:"Unit",placeholder:"Your unit",value:e.unit,onValueChange:e=>P(t,"unit",e)}),(0,r.jsx)(u.A,{className:"bg-danger",onClick:()=>_(t),children:"Remove"})]},t)),(0,r.jsx)(u.A,{onClick:()=>{U(e=>[...e,new T(0,"","")])},className:"mt-4 bg-primary",children:"+ Add Ingredient"})]})]}),(0,r.jsxs)(j.R,{children:[(0,r.jsx)(u.A,{className:"bg-success",onClick:V,disabled:!F(),children:D?"Uploading...":"Save"}),(0,r.jsx)(u.A,{className:"bg-danger",onClick:s,children:"Close"})]})]})})},I=()=>{let[e,t]=(0,l.useState)([]),[s,n]=(0,l.useState)(!0),[i,a]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{(async()=>{try{let e=await c.Z.get("recipes");t(e)}catch(e){console.error("Failed to fetch recipes:",e)}finally{n(!1)}})()},[]),s)?(0,r.jsx)("p",{className:"text-center mt-10",children:"Loading recipes..."}):(0,r.jsxs)(o.Z,{children:[(0,r.jsxs)("div",{className:"container mx-auto px-4 py-10",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-center mb-6",children:"All Recipes"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((e,t)=>(0,r.jsx)(E,{recipe:e},t))})]}),(0,r.jsx)(u.A,{onClick:()=>{a(!0)},children:"Create Recipe"}),(0,r.jsx)(y,{isOpen:i,onClose:()=>{a(!1)}})]})}},54719:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(57437),i=s(2265),a=s(59331),r=s(8284);let l=e=>{let{children:t}=e,[s,l]=(0,i.useState)(!0),[o,c]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{a.Z.getInstance().getUser()?c(!0):c(!1),l(!1)},[]),s)?(0,n.jsx)("div",{children:"Loading..."}):o?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"You are not logged in."}),(0,n.jsx)(r.A,{onClick:()=>window.location.href="/login",children:"Go to Login"})]})}},59331:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}setUser(e,t,s,n,i,a,r,l){this.user={id:e,username:t,firstName:s,lastName:n,email:i,profileImageUrl:a,uuid:r,token:l},sessionStorage.setItem("user",JSON.stringify(this.user))}getUser(){return this.user}isAuthenticated(){return null!==this.user}clearUser(){this.user=null,sessionStorage.removeItem("user")}constructor(){if(this.user=null,window.sessionStorage){let e=sessionStorage.getItem("user");e&&(this.user=JSON.parse(e))}else console.warn("sessionStorage is not available in this environment.")}}let i=n},67671:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(59331);class i{setToken(e,t){this.token=e;let s=new Date().getTime()+t;sessionStorage.setItem("authToken",e),sessionStorage.setItem("authTokenExpiration",s.toString())}clearToken(){this.token=null,sessionStorage.removeItem("authToken"),sessionStorage.removeItem("authTokenExpiration")}async fetchApi(e){let{method:t="GET",body:s,headers:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="".concat(this.baseUrl,"/").concat(e),a=s instanceof FormData,r={method:t,headers:{...n,...this.token?{Authorization:"Bearer ".concat(this.token)}:{},"Content-Type":n["Content-Type"]||"application/json"},body:a?s:s?JSON.stringify(s):void 0},l=await fetch(i,r);if(!l.ok)throw r.body&&console.log(r.body),console.log(await l.text()),Error("Failed to fetch: ".concat(l.json()));return l.json()}async login(e,t){let{token:s,expiresIn:i}=await this.fetchApi("auth/login",{method:"POST",body:{email:e,password:t}});this.setToken(s,i);let a=await this.fetchApi("auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(s)}});n.Z.getInstance().setUser(a.id,a.username,a.firstName,a.lastName,a.email,a.profileImageUrl,a.uuid,s)}async register(e,t,s,i,a,r,l){if(await this.fetchApi("auth/register",{method:"POST",body:{firstName:a,lastName:r,username:e,password:s,confirmPassword:i,email:t}}),await this.login(t,s),l){let e=new FormData;e.append("profileImage",l),await this.fetchApi("upload-profile-image",{method:"POST",body:e,headers:{"Content-Type":"multipart/form-data"}});let t=await this.fetchApi("auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(this.token)}});n.Z.getInstance().setUser(t.id,t.username,t.firstName,t.lastName,t.email,t.profileImageUrl,t.uuid,this.token)}}async logout(){try{var e;(null===(e=n.Z.getInstance().getUser())||void 0===e?void 0:e.token)&&await this.fetchApi("auth/logout",{method:"POST"})}catch(e){console.error("Failed to log out on server:",e)}n.Z.getInstance().clearUser(),this.clearToken(),window.location.href="/login"}async get(e,t){return this.fetchApi(e,{method:"GET",headers:t})}async post(e,t,s){return this.fetchApi(e,{method:"POST",body:t,headers:s})}async put(e,t,s){return this.fetchApi(e,{method:"PUT",body:t,headers:s})}async delete(e,t){return this.fetchApi(e,{method:"DELETE",headers:t})}constructor(e){if(this.token=null,!e)throw Error("API base URL is not defined.");this.baseUrl=e;{let e=sessionStorage.getItem("authToken"),t=sessionStorage.getItem("authTokenExpiration");e&&t&&new Date().getTime()<Number(t)?this.token=e:this.clearToken()}}}let a=new i("https://localhost/apiProd/api")}},e=>{var t=t=>e(e.s=t);e.O(0,[284,121,711,130,268,744],()=>t(24863)),_N_E=e.O()}]);
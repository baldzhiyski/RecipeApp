(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{81770:(e,t,s)=>{Promise.resolve().then(s.bind(s,70529))},70529:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var i=s(57437),n=s(54719),o=s(59331),a=s(67671),r=s(8284);let l=()=>{let e=o.Z.getInstance().getUser();return(0,i.jsxs)(n.Z,{children:[(0,i.jsxs)("div",{children:["Username: ",null==e?void 0:e.username]}),(0,i.jsxs)("div",{children:["Firstname: ",null==e?void 0:e.firstName]}),(0,i.jsxs)("div",{children:["Lastname: ",null==e?void 0:e.lastName]}),(0,i.jsxs)("div",{children:["Email: ",null==e?void 0:e.email]}),(0,i.jsxs)("div",{children:["UUID: ",null==e?void 0:e.uuid]}),(0,i.jsx)(r.A,{onClick:()=>{a.Z.logout()},children:"Logout"})]})}},54719:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var i=s(57437),n=s(2265),o=s(59331),a=s(8284);let r=e=>{let{children:t}=e,[s,r]=(0,n.useState)(!0),[l,h]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{o.Z.getInstance().getUser()?h(!0):h(!1),r(!1)},[]),s)?(0,i.jsx)("div",{children:"Loading..."}):l?(0,i.jsx)(i.Fragment,{children:t}):(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"You are not logged in."}),(0,i.jsx)(a.A,{onClick:()=>window.location.href="/login",children:"Go to Login"})]})}},59331:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}setUser(e,t,s,i,n,o,a,r){this.user={id:e,username:t,firstName:s,lastName:i,email:n,profileImageUrl:o,uuid:a,token:r},sessionStorage.setItem("user",JSON.stringify(this.user))}getUser(){return this.user}isAuthenticated(){return null!==this.user}clearUser(){this.user=null,sessionStorage.removeItem("user")}constructor(){if(this.user=null,window.sessionStorage){let e=sessionStorage.getItem("user");e&&(this.user=JSON.parse(e))}else console.warn("sessionStorage is not available in this environment.")}}let n=i},67671:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(59331);class n{setToken(e,t){this.token=e;let s=new Date().getTime()+t;sessionStorage.setItem("authToken",e),sessionStorage.setItem("authTokenExpiration",s.toString())}clearToken(){this.token=null,sessionStorage.removeItem("authToken"),sessionStorage.removeItem("authTokenExpiration")}async fetchApi(e){let{method:t="GET",body:s,headers:i={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(this.baseUrl,"/").concat(e),o=s instanceof FormData,a={method:t,headers:{...i,...this.token?{Authorization:"Bearer ".concat(this.token)}:{},"Content-Type":i["Content-Type"]||"application/json"},body:o?s:s?JSON.stringify(s):void 0},r=await fetch(n,a);if(!r.ok)throw a.body&&console.log(a.body),console.log(await r.text()),Error("Failed to fetch: ".concat(r.json()));return r.json()}async login(e,t){let{token:s,expiresIn:n}=await this.fetchApi("auth/login",{method:"POST",body:{email:e,password:t}});this.setToken(s,n);let o=await this.fetchApi("auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(s)}});i.Z.getInstance().setUser(o.id,o.username,o.firstName,o.lastName,o.email,o.profileImageUrl,o.uuid,s)}async register(e,t,s,n,o,a,r){if(await this.fetchApi("auth/register",{method:"POST",body:{firstName:o,lastName:a,username:e,password:s,confirmPassword:n,email:t}}),await this.login(t,s),r){let e=new FormData;e.append("profileImage",r),await this.fetchApi("upload-profile-image",{method:"POST",body:e,headers:{"Content-Type":"multipart/form-data"}});let t=await this.fetchApi("auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(this.token)}});i.Z.getInstance().setUser(t.id,t.username,t.firstName,t.lastName,t.email,t.profileImageUrl,t.uuid,this.token)}}async logout(){try{var e;(null===(e=i.Z.getInstance().getUser())||void 0===e?void 0:e.token)&&await this.fetchApi("auth/logout",{method:"POST"})}catch(e){console.error("Failed to log out on server:",e)}i.Z.getInstance().clearUser(),this.clearToken(),window.location.href="/login"}async get(e,t){return this.fetchApi(e,{method:"GET",headers:t})}async post(e,t,s){return this.fetchApi(e,{method:"POST",body:t,headers:s})}async put(e,t,s){return this.fetchApi(e,{method:"PUT",body:t,headers:s})}async delete(e,t){return this.fetchApi(e,{method:"DELETE",headers:t})}constructor(e){if(this.token=null,!e)throw Error("API base URL is not defined.");this.baseUrl=e;{let e=sessionStorage.getItem("authToken"),t=sessionStorage.getItem("authTokenExpiration");e&&t&&new Date().getTime()<Number(t)?this.token=e:this.clearToken()}}}let o=new n("https://localhost/apiProd/api")}},e=>{var t=t=>e(e.s=t);e.O(0,[284,130,268,744],()=>t(81770)),_N_E=e.O()}]);